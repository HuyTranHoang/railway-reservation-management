<nb-card>
  <nb-card-header>Define New Carriage</nb-card-header>
  <nb-card-body>
    <nb-stepper orientation="horizontal" disableStepNavigation>

<!--      <nb-step [label]="labelOne" [stepControl]="carriageForm">-->
        <nb-step [label]="labelOne">
        <ng-template #labelOne>First step</ng-template>
        <h4>Define New Carriage</h4>

        <form [formGroup]="carriageForm" class="my-4 col-6 p-0">

          <div class="form-group">
            <label class="label">Train name/code</label>
            <input #autoInput
                   class="mr-4"
                   [class.status-danger]="isSubmitted && !isValidTrainSelected"
                   nbInput
                   fullWidth
                   type="text"
                   (input)="onChange()"
                   (blur)="onInputBlur()"
                   placeholder="Choose train name/code.."
                   [nbAutocomplete]="autoTrainName" />
            <nb-autocomplete #autoTrainName (selectedChange)="onSelectionChange($event)">
              <nb-option *ngFor="let option of filteredOptions$ | async" [value]="option">
                {{ option.name }}
              </nb-option>
            </nb-autocomplete>
            <span *ngIf="isSubmitted && !isValidTrainSelected" class="text-danger">
              *Please select a valid train
            </span>
          </div>

          <div class="form-group">
            <label class="label">Carriage Type</label>
            <nb-select fullWidth formControlName="carriageTypeId"
                       [class.status-danger]="carriageForm.get('carriageTypeId').hasError('required') && isSubmitted"
                       placeholder="Type of this carriage..">
              <nb-option *ngFor="let option of carriageTypes" [value]="option.id">{{ option.name }}</nb-option>
            </nb-select>
            <span class="text-danger"
              *ngIf="carriageForm.get('carriageTypeId').hasError('required') && isSubmitted">
                *Please select a valid carriage type
              </span>
          </div>

          <app-input-field [control]="carriageForm.get('name')"
                           [label]="'Name'"
                           [isSubmitted]="isSubmitted"
                           [placeholder]="'Name of carriage..'">
          </app-input-field>

        </form>

        <div *ngIf="isSubmitted && carriageForm.invalid" class="mb-3">
          <span class="text-danger">*Please fill the valid form to continue</span>
        </div>

        <button class="prev-button" nbButton disabled nbStepperNext>prev</button>
        <button class="next-button" nbButton nbStepperNext (click)="firstNextBtnClick()">next</button>
      </nb-step>

      <nb-step [label]="labelTwo">
        <ng-template #labelTwo>Second step</ng-template>
        <h4>Preview compartment belong to this carriage</h4>
        <hr>
        <p>
          This section provides an automated preview of the compartment and seating layout based on your <b>previously selected carriage type</b>.
          It is designed to help you visualize the interior configuration and ensure the arrangement meets your requirements for space and comfort.
        </p>
        <p>
          Please review the compartment and seat details shown here to confirm they align with your expectations for the carriage design.
        </p>
        <div class="row">
          <div class="col-4">
            <h6>Compartment information</h6>
            <app-input-field [control]="compartmentForm.get('name')"
                             [label]="'Name'"
                             [isSubmitted]="isCompartmentSubmitted"
                             [placeholder]="'Name of compartment..'">
            </app-input-field>
            <app-input-field [control]="compartmentForm.get('numberOfSeats')"
                             [label]="'Total compartments'"
                             [isSubmitted]="isCompartmentSubmitted"
                             [placeholder]="'Total compartments..'">
            </app-input-field>
            <app-input-field [control]="compartmentForm.get('numberOfSeats')"
                             [label]="'Number of seats (per compartment)'"
                             [isSubmitted]="isCompartmentSubmitted"
                             [placeholder]="'Number of seats..'">
            </app-input-field>
          </div>

          <div class="col-6" style="margin-top: 32px">
            <label class="label">Carriage preview</label>
            <div class="mt-3">
              <app-preview-carriage></app-preview-carriage>
            </div>
          </div>
        </div>

        <button class="prev-button" nbButton nbStepperPrevious>prev</button>
        <button class="next-button" nbButton nbStepperNext>next</button>
      </nb-step>

      <nb-step label="Third step">
        <h4>Step content #3</h4>
        <p class="lorem">
          Lorizzle ipsum dolizzle stuff fizzle, consectetuer adipiscing break it down.
          Nullizzle sapien velizzle, my shizz pimpin', shizzle my nizzle crocodizzle shut the shizzle up,
          gravida vizzle, dang.
        </p>
        <button class="prev-button" nbButton nbStepperPrevious>prev</button>
        <button class="next-button" nbButton nbStepperNext>next</button>
      </nb-step>

      <nb-step [label]="labelFour">
        <ng-template #labelFour>Fourth step</ng-template>
        <h4>Step content #4</h4>
        <p class="lorem">
          Lorizzle ipsum dolizzle stuff fizzle, consectetuer adipiscing break it down.
          Nullizzle sapien velizzle, my shizz pimpin', shizzle my nizzle crocodizzle shut the shizzle up,
          gravida vizzle, dang.
        </p>
        <button class="prev-button" nbButton nbStepperPrevious>prev</button>
        <button class="next-button" nbButton disabled nbStepperNext>next</button>
      </nb-step>

    </nb-stepper>
  </nb-card-body>
</nb-card>
